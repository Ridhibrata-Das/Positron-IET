(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[783],{14097:function(e,t,a){Promise.resolve().then(a.bind(a,90055))},90055:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return y}});var r=a(57437),s=a(2265),i=a(86110),l=a(45253),n=a(78606),o=a(16573),d=a(24235),c=a(50039),h=a(86812),u=a(79857),f=a(19223),m=a(74587),x=a(84180),p=a(71424),j=a(58094);let g=[{value:"1h",label:"Last Hour"},{value:"24h",label:"Last 24 Hours"},{value:"7d",label:"Last 7 Days"},{value:"30d",label:"Last 30 Days"},{value:"1y",label:"Last Year"}];function y(){let[e,t]=(0,s.useState)([]),[a,y]=(0,s.useState)("24h"),[N,w]=(0,s.useState)(!0);return(0,s.useEffect)(()=>{let e=async()=>{try{w(!0);let e=await (0,x.CH)(a);t(e)}catch(e){console.error("Error fetching sensor data:",e),p.toast.error("Failed to fetch sensor data. Please try again later.")}finally{w(!1)}};e();let r={"1h":15e3,"24h":6e4,"7d":3e5,"30d":9e5,"1y":36e5}[a]||6e4,s=setInterval(e,r);return()=>clearInterval(s)},[a]),(0,r.jsxs)("div",{className:"p-8",children:[(0,r.jsx)("div",{className:"flex justify-between items-center mb-8",children:(0,r.jsx)("h1",{className:"text-3xl font-bold",children:"Sensor Readings"})}),(0,r.jsxs)("div",{className:"grid grid-cols-1 gap-8",children:[(0,r.jsxs)(i.Zb,{className:"p-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold",children:"Temperature History"}),(0,r.jsxs)(j.Ph,{value:a,onValueChange:y,children:[(0,r.jsx)(j.i4,{className:"w-[180px]",children:(0,r.jsx)(j.ki,{placeholder:"Select time range"})}),(0,r.jsx)(j.Bw,{children:g.map(e=>(0,r.jsx)(j.Ql,{value:e.value,children:e.label},e.value))})]})]}),(0,r.jsx)("div",{className:"h-[300px]",children:(0,r.jsx)(l.h,{width:"100%",height:"100%",children:(0,r.jsxs)(n.w,{data:e,children:[(0,r.jsx)(o.q,{strokeDasharray:"3 3"}),(0,r.jsx)(d.K,{dataKey:"time"}),(0,r.jsx)(c.B,{}),(0,r.jsx)(h.u,{}),(0,r.jsx)(u.D,{}),(0,r.jsx)(f.x,{type:"monotone",dataKey:"temperature",name:"Temperature (\xb0C)",stroke:"#2563eb",strokeWidth:2,dot:!1}),(0,r.jsx)(m.B,{dataKey:"time",height:30,stroke:"#2563eb"})]})})})]}),(0,r.jsxs)(i.Zb,{className:"p-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold",children:"Humidity History"}),(0,r.jsxs)(j.Ph,{value:a,onValueChange:y,children:[(0,r.jsx)(j.i4,{className:"w-[180px]",children:(0,r.jsx)(j.ki,{placeholder:"Select time range"})}),(0,r.jsx)(j.Bw,{children:g.map(e=>(0,r.jsx)(j.Ql,{value:e.value,children:e.label},e.value))})]})]}),(0,r.jsx)("div",{className:"h-[300px]",children:(0,r.jsx)(l.h,{width:"100%",height:"100%",children:(0,r.jsxs)(n.w,{data:e,children:[(0,r.jsx)(o.q,{strokeDasharray:"3 3"}),(0,r.jsx)(d.K,{dataKey:"time"}),(0,r.jsx)(c.B,{}),(0,r.jsx)(h.u,{}),(0,r.jsx)(u.D,{}),(0,r.jsx)(f.x,{type:"monotone",dataKey:"humidity",name:"Humidity (%)",stroke:"#16a34a",strokeWidth:2,dot:!1}),(0,r.jsx)(m.B,{dataKey:"time",height:30,stroke:"#16a34a"})]})})})]}),(0,r.jsxs)(i.Zb,{className:"p-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold",children:"Soil Moisture History"}),(0,r.jsxs)(j.Ph,{value:a,onValueChange:y,children:[(0,r.jsx)(j.i4,{className:"w-[180px]",children:(0,r.jsx)(j.ki,{placeholder:"Select time range"})}),(0,r.jsx)(j.Bw,{children:g.map(e=>(0,r.jsx)(j.Ql,{value:e.value,children:e.label},e.value))})]})]}),(0,r.jsx)("div",{className:"h-[300px]",children:(0,r.jsx)(l.h,{width:"100%",height:"100%",children:(0,r.jsxs)(n.w,{data:e,children:[(0,r.jsx)(o.q,{strokeDasharray:"3 3"}),(0,r.jsx)(d.K,{dataKey:"time"}),(0,r.jsx)(c.B,{}),(0,r.jsx)(h.u,{}),(0,r.jsx)(u.D,{}),(0,r.jsx)(f.x,{type:"monotone",dataKey:"soilMoisture",name:"Soil Moisture (%)",stroke:"#ea580c",strokeWidth:2,dot:!1}),(0,r.jsx)(m.B,{dataKey:"time",height:30,stroke:"#ea580c"})]})})})]})]})]})}},86110:function(e,t,a){"use strict";a.d(t,{Zb:function(){return l}});var r=a(57437),s=a(2265),i=a(39311);let l=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...s})});l.displayName="Card";let n=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",a),...s})});n.displayName="CardHeader";let o=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("h3",{ref:t,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",a),...s})});o.displayName="CardTitle";let d=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("p",{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",a),...s})});d.displayName="CardDescription";let c=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("p-6 pt-0",a),...s})});c.displayName="CardContent";let h=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("flex items-center p-6 pt-0",a),...s})});h.displayName="CardFooter"},58094:function(e,t,a){"use strict";a.d(t,{Bw:function(){return x},Ph:function(){return c},Ql:function(){return j},i4:function(){return u},ki:function(){return h}});var r=a(57437),s=a(2265),i=a(9390),l=a(83523),n=a(9224),o=a(62442),d=a(39311);let c=i.fC;i.ZA;let h=i.B4,u=s.forwardRef((e,t)=>{let{className:a,children:s,...n}=e;return(0,r.jsxs)(i.xz,{ref:t,className:(0,d.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...n,children:[s,(0,r.jsx)(i.JO,{asChild:!0,children:(0,r.jsx)(l.Z,{className:"h-4 w-4 opacity-50"})})]})});u.displayName=i.xz.displayName;let f=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(i.u_,{ref:t,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",a),...s,children:(0,r.jsx)(n.Z,{className:"h-4 w-4"})})});f.displayName=i.u_.displayName;let m=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(i.$G,{ref:t,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",a),...s,children:(0,r.jsx)(l.Z,{className:"h-4 w-4"})})});m.displayName=i.$G.displayName;let x=s.forwardRef((e,t)=>{let{className:a,children:s,position:l="popper",...n}=e;return(0,r.jsx)(i.h_,{children:(0,r.jsxs)(i.VY,{ref:t,className:(0,d.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:l,...n,children:[(0,r.jsx)(f,{}),(0,r.jsx)(i.l_,{className:(0,d.cn)("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),(0,r.jsx)(m,{})]})})});x.displayName=i.VY.displayName;let p=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(i.__,{ref:t,className:(0,d.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",a),...s})});p.displayName=i.__.displayName;let j=s.forwardRef((e,t)=>{let{className:a,children:s,...l}=e;return(0,r.jsxs)(i.ck,{ref:t,className:(0,d.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...l,children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(i.wU,{children:(0,r.jsx)(o.Z,{className:"h-4 w-4"})})}),(0,r.jsx)(i.eT,{children:s})]})});j.displayName=i.ck.displayName;let g=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(i.Z0,{ref:t,className:(0,d.cn)("-mx-1 my-1 h-px bg-muted",a),...s})});g.displayName=i.Z0.displayName},84180:function(e,t,a){"use strict";a.d(t,{CH:function(){return n},bW:function(){return l}});let r=e=>{let t="2647422",a="1IND2YTTTRS3WCNY";if(!t||!a)throw Error("ThingSpeak API configuration is missing");return"https://api.thingspeak.com/channels/".concat(t,"/feeds.json?api_key=").concat(a,"&results=").concat({"1h":60,"24h":1440,"7d":10080,"30d":43200,"1y":525600}[e]||1440)},s=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!e)return t;let a=parseFloat(e);return isNaN(a)?t:a},i=(e,t)=>{if(0===t)return{change:0,increasing:!1};let a=(e-t)/Math.abs(t)*100;return{change:Math.abs(parseFloat(a.toFixed(1))),increasing:a>0}},l=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"24h";try{let t=new AbortController,a=setTimeout(()=>t.abort(),5e3),l=await fetch(r(e),{signal:t.signal,next:{revalidate:30}});if(clearTimeout(a),!l.ok)throw Error("ThingSpeak API error: ".concat(l.status));let n=await l.json(),o=n.feeds;if(!o||0===o.length)throw Error("No data available from ThingSpeak");let d=o[o.length-1],c=o[o.length-2]||d,h=s(d.field1),u=s(c.field1),f=o.map(e=>({time:new Date(e.created_at).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0}),soilMoisture:s(e.field1),temperature:s(e.field2),humidity:s(e.field3)}));return{currentData:{time:new Date(d.created_at).toLocaleTimeString(),soilMoisture:h},historyData:f,trend:i(h,u)}}catch(e){if(console.error("Error fetching soil moisture data:",e),e instanceof Error&&"AbortError"===e.name)throw Error("ThingSpeak API request timed out");throw e}};async function n(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"24h";try{let t="2647422",a="1IND2YTTTRS3WCNY";if(!t||!a)throw Error("ThingSpeak configuration missing");let r=await fetch("https://api.thingspeak.com/channels/".concat(t,"/feeds.json?api_key=").concat(a,"&results=").concat({"1h":60,"24h":144,"7d":168,"30d":720,"1y":8760}[e]||144));if(!r.ok)throw Error("Failed to fetch ThingSpeak data");let s=await r.json();if(!s.feeds||0===s.feeds.length)return[];return s.feeds.map(e=>({soilMoisture:parseFloat(e.field1)||0,temperature:parseFloat(e.field2)||0,humidity:parseFloat(e.field3)||0,time:new Date(e.created_at).toLocaleTimeString()}))}catch(e){throw console.error("Error fetching ThingSpeak history:",e),e}}},39311:function(e,t,a){"use strict";a.d(t,{cn:function(){return i}});var r=a(57042),s=a(74769);function i(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,s.m6)((0,r.W)(t))}}},function(e){e.O(0,[533,424,642,971,864,744],function(){return e(e.s=14097)}),_N_E=e.O()}]);